/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/lightning_utilities/core/imports.py:14: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  import pkg_resources
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/pkg_resources/__init__.py:2871: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
  declare_namespace(pkg)
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/lightning_fabric/__init__.py:40: Deprecated call to `pkg_resources.declare_namespace('lightning_fabric')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/pytorch_lightning/__init__.py:37: Deprecated call to `pkg_resources.declare_namespace('pytorch_lightning')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/lightning/fabric/__init__.py:40: Deprecated call to `pkg_resources.declare_namespace('lightning.fabric')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('lightning')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
  declare_namespace(parent)
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/lightning/pytorch/__init__.py:37: Deprecated call to `pkg_resources.declare_namespace('lightning.pytorch')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/pkg_resources/__init__.py:2350: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('lightning')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
  declare_namespace(parent)
Seed set to 0
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/transformers/utils/generic.py:311: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:191: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python imbalanced_text_classification/main.py --data_name a ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]

  | Name               | Type                          | Params
---------------------------------------------------------------------
0 | classifier         | BertForSequenceClassification | 109 M 
1 | loss_fn            | CrossEntropyLoss              | 0     
2 | train_metrics      | MetricCollection              | 0     
3 | train_f1_per_label | MulticlassF1Score             | 0     
4 | val_metrics        | MetricCollection              | 0     
5 | val_f1_per_label   | MulticlassF1Score             | 0     
6 | test_metrics       | MetricCollection              | 0     
7 | test_f1_per_label  | MulticlassF1Score             | 0     
---------------------------------------------------------------------
109 M     Trainable params
0         Non-trainable params
109 M     Total params
437.944   Total estimated model params size (MB)
imbalalanced_text_classification_ami

MLFlow run_name = th-ami-multi
MLflow Saved Thresholding Log in './mlruns/11/f7606ba8199d45b2a01c594b98e92a58'
Using Cross Entropy Loss: alpha=None
Runing th model:
Parmas: {'sampling_modifiedRS_mode': None, 'sampling_modifiedRS_rho': None, 'sampling_weightedRS_percentage': None, 'wce_alpha': None, 'fl_gamma': None, 'loss': <Loss.CE_Loss: 'CE_Loss'>, 'adjusting_th': True}
Calling ImbalancedDataModule.setup() for train...
------ Dataset Statistics ------
Raw data reading from CSV files:
| Split	 | Size	 | Label Counts
| test	 | 460 |	0: 141, 30.7%	1: 140, 30.4%	2: 124, 27.0%	3: 44, 9.6%	4: 11, 2.4%
| train_val	 | 1785 |	0: 1014, 56.8%	1: 179, 10.0%	2: 148, 8.3%	3: 352, 19.7%	4: 92, 5.2%
After splitting for training:
| Split	 | Size	 | Label Counts
| train	 | 1338 |	0: 760, 56.8%	1: 134, 10.0%	2: 111, 8.3%	3: 264, 19.7%	4: 69, 5.2%
| val	 | 447 |	0: 254, 56.8%	1: 45, 10.1%	2: 37, 8.3%	3: 88, 19.7%	4: 23, 5.1%
| test	 | 460 |	0: 141, 30.7%	1: 140, 30.4%	2: 124, 27.0%	3: 44, 9.6%	4: 11, 2.4%
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=185000) is multi-threaded, use of fork() may lead to deadlocks in the child.
  self.pid = os.fork()
/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/pytorch_lightning/loops/fit_loop.py:293: The number of training batches (21) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/21 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/21 [00:00<?, ?it/s] Now in the training step
Epoch 0:   5%|▍         | 1/21 [00:01<00:23,  0.87it/s]Epoch 0:   5%|▍         | 1/21 [00:01<00:23,  0.87it/s, v_num=2a58]Now in the training step
Epoch 0:  10%|▉         | 2/21 [00:01<00:17,  1.07it/s, v_num=2a58]Epoch 0:  10%|▉         | 2/21 [00:01<00:17,  1.07it/s, v_num=2a58]Now in the training step
Epoch 0:  14%|█▍        | 3/21 [00:02<00:15,  1.16it/s, v_num=2a58]Epoch 0:  14%|█▍        | 3/21 [00:02<00:15,  1.16it/s, v_num=2a58]Now in the training step
Epoch 0:  19%|█▉        | 4/21 [00:03<00:14,  1.21it/s, v_num=2a58]Epoch 0:  19%|█▉        | 4/21 [00:03<00:14,  1.21it/s, v_num=2a58]Now in the training step
Epoch 0:  24%|██▍       | 5/21 [00:04<00:12,  1.24it/s, v_num=2a58]Epoch 0:  24%|██▍       | 5/21 [00:04<00:12,  1.24it/s, v_num=2a58]Now in the training step
Epoch 0:  29%|██▊       | 6/21 [00:04<00:11,  1.26it/s, v_num=2a58]Epoch 0:  29%|██▊       | 6/21 [00:04<00:11,  1.26it/s, v_num=2a58]Now in the training step
Epoch 0:  33%|███▎      | 7/21 [00:05<00:10,  1.28it/s, v_num=2a58]Epoch 0:  33%|███▎      | 7/21 [00:05<00:10,  1.28it/s, v_num=2a58]Now in the training step
Epoch 0:  38%|███▊      | 8/21 [00:06<00:10,  1.29it/s, v_num=2a58]Epoch 0:  38%|███▊      | 8/21 [00:06<00:10,  1.29it/s, v_num=2a58]Now in the training step
Epoch 0:  43%|████▎     | 9/21 [00:06<00:09,  1.30it/s, v_num=2a58]Epoch 0:  43%|████▎     | 9/21 [00:06<00:09,  1.30it/s, v_num=2a58]Now in the training step
Epoch 0:  48%|████▊     | 10/21 [00:07<00:08,  1.31it/s, v_num=2a58]Epoch 0:  48%|████▊     | 10/21 [00:07<00:08,  1.31it/s, v_num=2a58]Now in the training step
Epoch 0:  52%|█████▏    | 11/21 [00:08<00:07,  1.31it/s, v_num=2a58]Epoch 0:  52%|█████▏    | 11/21 [00:08<00:07,  1.31it/s, v_num=2a58]Now in the training step
Epoch 0:  57%|█████▋    | 12/21 [00:09<00:06,  1.32it/s, v_num=2a58]Epoch 0:  57%|█████▋    | 12/21 [00:09<00:06,  1.32it/s, v_num=2a58]Now in the training step
Epoch 0:  62%|██████▏   | 13/21 [00:09<00:06,  1.33it/s, v_num=2a58]Epoch 0:  62%|██████▏   | 13/21 [00:09<00:06,  1.33it/s, v_num=2a58]Now in the training step
Epoch 0:  67%|██████▋   | 14/21 [00:10<00:05,  1.33it/s, v_num=2a58]Epoch 0:  67%|██████▋   | 14/21 [00:10<00:05,  1.33it/s, v_num=2a58]Now in the training step
Epoch 0:  71%|███████▏  | 15/21 [00:11<00:04,  1.33it/s, v_num=2a58]Epoch 0:  71%|███████▏  | 15/21 [00:11<00:04,  1.33it/s, v_num=2a58]Now in the training step
Epoch 0:  76%|███████▌  | 16/21 [00:11<00:03,  1.33it/s, v_num=2a58]Epoch 0:  76%|███████▌  | 16/21 [00:11<00:03,  1.33it/s, v_num=2a58]Now in the training step
Epoch 0:  81%|████████  | 17/21 [00:12<00:02,  1.34it/s, v_num=2a58]Epoch 0:  81%|████████  | 17/21 [00:12<00:02,  1.34it/s, v_num=2a58]Now in the training step
Epoch 0:  86%|████████▌ | 18/21 [00:13<00:02,  1.34it/s, v_num=2a58]Epoch 0:  86%|████████▌ | 18/21 [00:13<00:02,  1.34it/s, v_num=2a58]Now in the training step
Epoch 0:  90%|█████████ | 19/21 [00:14<00:01,  1.34it/s, v_num=2a58]Epoch 0:  90%|█████████ | 19/21 [00:14<00:01,  1.34it/s, v_num=2a58]Now in the training step
Epoch 0:  95%|█████████▌| 20/21 [00:14<00:00,  1.34it/s, v_num=2a58]Epoch 0:  95%|█████████▌| 20/21 [00:14<00:00,  1.34it/s, v_num=2a58]Now in the training step
Epoch 0: 100%|██████████| 21/21 [00:15<00:00,  1.35it/s, v_num=2a58]Epoch 0: 100%|██████████| 21/21 [00:15<00:00,  1.35it/s, v_num=2a58]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  14%|█▍        | 1/7 [00:01<00:09,  0.67it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  29%|██▊       | 2/7 [00:02<00:07,  0.71it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  43%|████▎     | 3/7 [00:03<00:04,  0.95it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  57%|█████▋    | 4/7 [00:03<00:02,  1.15it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  71%|███████▏  | 5/7 [00:03<00:01,  1.32it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  86%|████████▌ | 6/7 [00:04<00:00,  1.46it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0: 100%|██████████| 7/7 [00:04<00:00,  1.58it/s][A/mounts/Users/cisintern/zhangyaq/anaconda3/envs/pl_env/lib/python3.12/site-packages/torchmetrics/utilities/prints.py:43: TorchMetricsUserWarning: You are trying to use a metric in deterministic mode on GPU that uses `torch.cumsum`, which is currently not supported. The tensor will be copied to the CPU memory to compute it and then copied back to GPU. Expect some slowdowns.
  warnings.warn(*args, **kwargs)  # noqa: B028
Now on_validation_epoch_end

                                                                      [AEpoch 0: 100%|██████████| 21/21 [00:22<00:00,  0.95it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000]Epoch 0: 100%|██████████| 21/21 [00:22<00:00,  0.95it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000]Now on_train_epoch_end
Epoch 0:   0%|          | 0/21 [00:00<?, ?it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000]         Epoch 1:   0%|          | 0/21 [00:00<?, ?it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000]Now in the training step
Epoch 1:   5%|▍         | 1/21 [00:02<00:42,  0.47it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000]Epoch 1:   5%|▍         | 1/21 [00:02<00:42,  0.47it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  10%|▉         | 2/21 [00:02<00:26,  0.71it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  10%|▉         | 2/21 [00:02<00:26,  0.71it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  14%|█▍        | 3/21 [00:03<00:21,  0.84it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  14%|█▍        | 3/21 [00:03<00:21,  0.84it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  19%|█▉        | 4/21 [00:04<00:18,  0.93it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  19%|█▉        | 4/21 [00:04<00:18,  0.93it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  24%|██▍       | 5/21 [00:05<00:16,  0.99it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  24%|██▍       | 5/21 [00:05<00:16,  0.99it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  29%|██▊       | 6/21 [00:05<00:14,  1.04it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  29%|██▊       | 6/21 [00:05<00:14,  1.04it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  33%|███▎      | 7/21 [00:06<00:12,  1.08it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  33%|███▎      | 7/21 [00:06<00:12,  1.08it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  38%|███▊      | 8/21 [00:07<00:11,  1.11it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  38%|███▊      | 8/21 [00:07<00:11,  1.11it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  43%|████▎     | 9/21 [00:07<00:10,  1.13it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  43%|████▎     | 9/21 [00:07<00:10,  1.13it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  48%|████▊     | 10/21 [00:08<00:09,  1.15it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  48%|████▊     | 10/21 [00:08<00:09,  1.15it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  52%|█████▏    | 11/21 [00:09<00:08,  1.17it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  52%|█████▏    | 11/21 [00:09<00:08,  1.17it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  57%|█████▋    | 12/21 [00:10<00:07,  1.18it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  57%|█████▋    | 12/21 [00:10<00:07,  1.18it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  62%|██████▏   | 13/21 [00:10<00:06,  1.19it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  62%|██████▏   | 13/21 [00:10<00:06,  1.19it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  67%|██████▋   | 14/21 [00:11<00:05,  1.21it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  67%|██████▋   | 14/21 [00:11<00:05,  1.21it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  71%|███████▏  | 15/21 [00:12<00:04,  1.21it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  71%|███████▏  | 15/21 [00:12<00:04,  1.21it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  76%|███████▌  | 16/21 [00:13<00:04,  1.22it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  76%|███████▌  | 16/21 [00:13<00:04,  1.22it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  81%|████████  | 17/21 [00:13<00:03,  1.23it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  81%|████████  | 17/21 [00:13<00:03,  1.23it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  86%|████████▌ | 18/21 [00:14<00:02,  1.24it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  86%|████████▌ | 18/21 [00:14<00:02,  1.24it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  90%|█████████ | 19/21 [00:15<00:01,  1.24it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  90%|█████████ | 19/21 [00:15<00:01,  1.24it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1:  95%|█████████▌| 20/21 [00:16<00:00,  1.25it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1:  95%|█████████▌| 20/21 [00:16<00:00,  1.25it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 1: 100%|██████████| 21/21 [00:16<00:00,  1.26it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1: 100%|██████████| 21/21 [00:16<00:00,  1.26it/s, v_num=2a58, val_loss=1.200, val_accuracy=0.237, val_auprc=0.332, val_f1_macro=0.137, val_f1_weighted=0.239, val_precision_macro=0.238, val_precision_weighted=0.474, val_recall_macro=0.247, val_recall_weighted=0.237, val_f1_per_label_0=0.337, val_f1_per_label_1=0.215, val_f1_per_label_2=0.000, val_f1_per_label_3=0.132, val_f1_per_label_4=0.000, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:01,  3.02it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:01,  3.03it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:01,  3.02it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  57%|█████▋    | 4/7 [00:01<00:00,  3.01it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  71%|███████▏  | 5/7 [00:01<00:00,  3.02it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  86%|████████▌ | 6/7 [00:01<00:00,  3.03it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0: 100%|██████████| 7/7 [00:02<00:00,  3.05it/s][ANow on_validation_epoch_end

                                                                      [AEpoch 1: 100%|██████████| 21/21 [00:20<00:00,  1.01it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 1: 100%|██████████| 21/21 [00:20<00:00,  1.01it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now on_train_epoch_end
Epoch 1:   0%|          | 0/21 [00:00<?, ?it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]         Epoch 2:   0%|          | 0/21 [00:00<?, ?it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:   5%|▍         | 1/21 [00:02<00:40,  0.49it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.270, train_accuracy=0.553, train_auprc=0.204, train_f1_macro=0.155, train_f1_weighted=0.416, train_precision_macro=0.247, train_precision_weighted=0.396, train_recall_macro=0.200, train_recall_weighted=0.553, train_f1_per_label_0=0.714, train_f1_per_label_1=0.000, train_f1_per_label_2=0.0177, train_f1_per_label_3=0.0458, train_f1_per_label_4=0.000]Epoch 2:   5%|▍         | 1/21 [00:02<00:40,  0.49it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  10%|▉         | 2/21 [00:02<00:26,  0.72it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  10%|▉         | 2/21 [00:02<00:26,  0.72it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  14%|█▍        | 3/21 [00:03<00:21,  0.85it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  14%|█▍        | 3/21 [00:03<00:21,  0.85it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  19%|█▉        | 4/21 [00:04<00:18,  0.94it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  19%|█▉        | 4/21 [00:04<00:18,  0.94it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  24%|██▍       | 5/21 [00:04<00:15,  1.00it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  24%|██▍       | 5/21 [00:04<00:15,  1.00it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  29%|██▊       | 6/21 [00:05<00:14,  1.05it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  29%|██▊       | 6/21 [00:05<00:14,  1.05it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  33%|███▎      | 7/21 [00:06<00:12,  1.09it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  33%|███▎      | 7/21 [00:06<00:12,  1.09it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  38%|███▊      | 8/21 [00:07<00:11,  1.12it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  38%|███▊      | 8/21 [00:07<00:11,  1.12it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  43%|████▎     | 9/21 [00:07<00:10,  1.14it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  43%|████▎     | 9/21 [00:07<00:10,  1.14it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  48%|████▊     | 10/21 [00:08<00:09,  1.16it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  48%|████▊     | 10/21 [00:08<00:09,  1.16it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  52%|█████▏    | 11/21 [00:09<00:08,  1.18it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  52%|█████▏    | 11/21 [00:09<00:08,  1.18it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  57%|█████▋    | 12/21 [00:10<00:07,  1.19it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  57%|█████▋    | 12/21 [00:10<00:07,  1.19it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  62%|██████▏   | 13/21 [00:10<00:06,  1.20it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  62%|██████▏   | 13/21 [00:10<00:06,  1.20it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  67%|██████▋   | 14/21 [00:11<00:05,  1.21it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  67%|██████▋   | 14/21 [00:11<00:05,  1.21it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  71%|███████▏  | 15/21 [00:12<00:04,  1.22it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  71%|███████▏  | 15/21 [00:12<00:04,  1.22it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  76%|███████▌  | 16/21 [00:13<00:04,  1.23it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  76%|███████▌  | 16/21 [00:13<00:04,  1.23it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  81%|████████  | 17/21 [00:13<00:03,  1.24it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  81%|████████  | 17/21 [00:13<00:03,  1.24it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  86%|████████▌ | 18/21 [00:14<00:02,  1.24it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  86%|████████▌ | 18/21 [00:14<00:02,  1.24it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  90%|█████████ | 19/21 [00:15<00:01,  1.25it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  90%|█████████ | 19/21 [00:15<00:01,  1.25it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2:  95%|█████████▌| 20/21 [00:15<00:00,  1.26it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2:  95%|█████████▌| 20/21 [00:15<00:00,  1.26it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Now in the training step
Epoch 2: 100%|██████████| 21/21 [00:16<00:00,  1.27it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2: 100%|██████████| 21/21 [00:16<00:00,  1.27it/s, v_num=2a58, val_loss=1.070, val_accuracy=0.577, val_auprc=0.420, val_f1_macro=0.414, val_f1_weighted=0.568, val_precision_macro=0.393, val_precision_weighted=0.595, val_recall_macro=0.474, val_recall_weighted=0.577, val_f1_per_label_0=0.709, val_f1_per_label_1=0.395, val_f1_per_label_2=0.000, val_f1_per_label_3=0.520, val_f1_per_label_4=0.444, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:01,  3.10it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:01,  3.08it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:01,  3.08it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  57%|█████▋    | 4/7 [00:01<00:00,  3.08it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  71%|███████▏  | 5/7 [00:01<00:00,  3.07it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0:  86%|████████▌ | 6/7 [00:01<00:00,  3.08it/s][ANow validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')

Validation DataLoader 0: 100%|██████████| 7/7 [00:02<00:00,  3.09it/s][ANow on_validation_epoch_end

                                                                      [AEpoch 2: 100%|██████████| 21/21 [00:20<00:00,  1.01it/s, v_num=2a58, val_loss=1.110, val_accuracy=0.445, val_auprc=0.399, val_f1_macro=0.374, val_f1_weighted=0.481, val_precision_macro=0.385, val_precision_weighted=0.617, val_recall_macro=0.474, val_recall_weighted=0.445, val_f1_per_label_0=0.557, val_f1_per_label_1=0.288, val_f1_per_label_2=0.165, val_f1_per_label_3=0.534, val_f1_per_label_4=0.327, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Epoch 2: 100%|██████████| 21/21 [00:20<00:00,  1.01it/s, v_num=2a58, val_loss=1.110, val_accuracy=0.445, val_auprc=0.399, val_f1_macro=0.374, val_f1_weighted=0.481, val_precision_macro=0.385, val_precision_weighted=0.617, val_recall_macro=0.474, val_recall_weighted=0.445, val_f1_per_label_0=0.557, val_f1_per_label_1=0.288, val_f1_per_label_2=0.165, val_f1_per_label_3=0.534, val_f1_per_label_4=0.327, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]`Trainer.fit` stopped: `max_epochs=3` reached.
Now on_train_epoch_end
Epoch 2: 100%|██████████| 21/21 [00:21<00:00,  0.98it/s, v_num=2a58, val_loss=1.110, val_accuracy=0.445, val_auprc=0.399, val_f1_macro=0.374, val_f1_weighted=0.481, val_precision_macro=0.385, val_precision_weighted=0.617, val_recall_macro=0.474, val_recall_weighted=0.445, val_f1_per_label_0=0.557, val_f1_per_label_1=0.288, val_f1_per_label_2=0.165, val_f1_per_label_3=0.534, val_f1_per_label_4=0.327, train_loss=1.150, train_accuracy=0.564, train_auprc=0.322, train_f1_macro=0.172, train_f1_weighted=0.426, train_precision_macro=0.342, train_precision_weighted=0.500, train_recall_macro=0.211, train_recall_weighted=0.564, train_f1_per_label_0=0.722, train_f1_per_label_1=0.0759, train_f1_per_label_2=0.0333, train_f1_per_label_3=0.0296, train_f1_per_label_4=0.000]Restoring states from the checkpoint path at /mounts/Users/cisintern/zhangyaq/imbalanced_text_classification/mlruns/11/f7606ba8199d45b2a01c594b98e92a58/artifacts/model_checkpoints/ami-th-seed0-epoch=01-val_f1_macro=0.41.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
Loaded model weights from the checkpoint at /mounts/Users/cisintern/zhangyaq/imbalanced_text_classification/mlruns/11/f7606ba8199d45b2a01c594b98e92a58/artifacts/model_checkpoints/ami-th-seed0-epoch=01-val_f1_macro=0.41.ckpt

Calling ImbalancedDataModule.setup() for validation/test...
Validation: |          | 0/? [00:00<?, ?it/s]Validation:   0%|          | 0/7 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s]Now validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:02,  2.79it/s]Now validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:01,  2.86it/s]Now validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Validation DataLoader 0:  43%|████▎     | 3/7 [00:01<00:01,  2.92it/s]Now validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:01<00:01,  2.95it/s]Now validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:01<00:00,  2.97it/s]Now validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:02<00:00,  2.98it/s]Now validation_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Validation DataLoader 0: 100%|██████████| 7/7 [00:02<00:00,  3.01it/s]Now on_validation_epoch_end
Validation DataLoader 0: 100%|██████████| 7/7 [00:02<00:00,  2.47it/s]Restoring states from the checkpoint path at /mounts/Users/cisintern/zhangyaq/imbalanced_text_classification/mlruns/11/f7606ba8199d45b2a01c594b98e92a58/artifacts/model_checkpoints/ami-th-seed0-epoch=01-val_f1_macro=0.41.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
Loaded model weights from the checkpoint at /mounts/Users/cisintern/zhangyaq/imbalanced_text_classification/mlruns/11/f7606ba8199d45b2a01c594b98e92a58/artifacts/model_checkpoints/ami-th-seed0-epoch=01-val_f1_macro=0.41.ckpt

────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_accuracy          0.5771812200546265
        val_auprc           0.4195598065853119
      val_f1_macro          0.4137458801269531
   val_f1_per_label_0       0.7092511057853699
   val_f1_per_label_1       0.39534884691238403
   val_f1_per_label_2               0.0
   val_f1_per_label_3       0.5196850299835205
   val_f1_per_label_4       0.4444444477558136
     val_f1_weighted        0.5679977536201477
        val_loss             1.069789171218872
   val_precision_macro      0.39344489574432373
 val_precision_weighted      0.595450758934021
    val_recall_macro        0.4740663468837738
   val_recall_weighted      0.5771812200546265
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Calling ImbalancedDataModule.setup() for validation/test...
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/8 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]Now test_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Testing DataLoader 0:  12%|█▎        | 1/8 [00:00<00:02,  2.95it/s]Now test_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Testing DataLoader 0:  25%|██▌       | 2/8 [00:00<00:01,  3.04it/s]Now test_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Testing DataLoader 0:  38%|███▊      | 3/8 [00:00<00:01,  3.03it/s]Now test_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Testing DataLoader 0:  50%|█████     | 4/8 [00:01<00:01,  3.00it/s]Now test_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Testing DataLoader 0:  62%|██████▎   | 5/8 [00:01<00:01,  3.00it/s]Now test_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Testing DataLoader 0:  75%|███████▌  | 6/8 [00:01<00:00,  3.00it/s]Now test_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Testing DataLoader 0:  88%|████████▊ | 7/8 [00:02<00:00,  3.00it/s]Now test_step
Threshold moving with train set priors = tensor([0.5680, 0.1001, 0.0830, 0.1973, 0.0516], device='cuda:1')
Testing DataLoader 0: 100%|██████████| 8/8 [00:02<00:00,  3.34it/s]Now on_test_epoch_end
Testing DataLoader 0: 100%|██████████| 8/8 [00:02<00:00,  2.76it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      test_accuracy         0.41304346919059753
       test_auprc           0.4493815004825592
      test_f1_macro         0.33355283737182617
   test_f1_per_label_0      0.4601770043373108
   test_f1_per_label_1      0.6359447240829468
   test_f1_per_label_2              0.0
   test_f1_per_label_3      0.4083769619464874
   test_f1_per_label_4      0.16326530277729034
    test_f1_weighted        0.37756896018981934
  test_precision_macro      0.3321225047111511
 test_precision_weighted    0.42137253284454346
    test_recall_macro       0.45920974016189575
  test_recall_weighted      0.41304346919059753
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
END running th.


